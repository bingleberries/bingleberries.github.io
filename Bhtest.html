<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Bing's Hub â€” Cinematic Space UI</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

<style>
  :root{
    --bg:#03040a;
    --panel: rgba(12,18,30,0.45);
    --glass: rgba(255,255,255,0.04);
    --accent1: #57b7ff;  /* cyan */
    --accent2: #9b6cff;  /* violet */
    --accent3: #6ee7b7;  /* mint */
    --muted: rgba(230,238,248,0.75);
    --glass-outline: rgba(255,255,255,0.06);
  }
  html,body{height:100%;margin:0;background:var(--bg);font-family:Inter, system-ui, Arial, sans-serif;color:#eaf4ff; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}

/* ----------------------
   Full canvas / visuals
   ---------------------- */
  #space {
    position:fixed; inset:0; z-index:0; display:block;
    background: radial-gradient(1200px 600px at 12% 12%, rgba(87,183,255,0.06), transparent 6%),
                radial-gradient(900px 600px at 84% 76%, rgba(155,108,255,0.06), transparent 6%),
                linear-gradient(180deg, rgba(2,6,16,1) 0%, rgba(3,6,12,1) 100%);
    pointer-events:none;
    mix-blend-mode: screen;
  }

  .nebula {
    position:fixed; inset:-10%; z-index:1; pointer-events:none;
    background:
      radial-gradient(40% 30% at 18% 22%, rgba(87,183,255,0.12), transparent 12%),
      radial-gradient(45% 32% at 78% 72%, rgba(155,108,255,0.10), transparent 12%),
      radial-gradient(30% 24% at 50% 45%, rgba(110,231,183,0.06), transparent 10%),
      transparent;
    filter: blur(28px) contrast(1.05) saturate(1.25);
    mix-blend-mode: screen;
    animation: nebulaDrift 30s linear infinite;
  }
  @keyframes nebulaDrift{
    0%{ transform: translate3d(0,0,0) scale(1) rotate(0deg); }
    50%{ transform: translate3d(-3%,2%,0) scale(1.04) rotate(0.6deg); }
    100%{ transform: translate3d(0,0,0) scale(1) rotate(0deg); }
  }

  .grain {
    position:fixed; inset:0; z-index:2; pointer-events:none;
    background-image: radial-gradient(white 0.6px, transparent 0.6px);
    opacity:0.02; transform: scale(1.25);
    mix-blend-mode: overlay;
  }

  /* cinematic lens flare */
  .bloom {
    position:fixed; inset:0; z-index:3; pointer-events:none;
    background: radial-gradient(800px 220px at 20% 14%, rgba(87,183,255,0.06), transparent 6%),
                radial-gradient(600px 180px at 82% 74%, rgba(155,108,255,0.05), transparent 6%);
    mix-blend-mode: screen;
    filter: blur(30px);
    opacity:0.95;
  }

/* ----------------------
   Layout containers
   ---------------------- */
  .shell {
    position:relative; z-index:6; min-height:100vh; display:grid;
    grid-template-columns: 1fr 440px; gap:22px; padding:38px;
  }

  /* left â€” hero + search + chips */
  .left {
    align-self:start; display:flex; gap:20px; flex-direction:column; max-width:1200px;
  }

  .hero {
    position:relative; display:flex; gap:18px; align-items:center; padding:28px; border-radius:18px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    backdrop-filter: blur(10px) saturate(1.05);
    border: 1px solid var(--glass-outline);
    box-shadow: 0 20px 60px rgba(1,6,18,0.6);
    overflow:visible;
  }

  .hero-left {
    min-width:64%; max-width:72%;
  }
  .hub-title { font-size:28px; margin:0; font-weight:800; letter-spacing: -0.02em; color: #eaf6ff; }
  .hub-sub { margin:8px 0 0 0; color:var(--muted); font-size:13px; }

  .hero-cta { margin-top:16px; display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  .btn {
    border-radius:12px; padding:10px 14px; font-weight:700; cursor:pointer; border:0; color:#00122a;
    background: linear-gradient(90deg, var(--accent1), var(--accent2)); box-shadow: 0 6px 24px rgba(92,122,255,0.12);
  }
  .btn.ghost {
    background: transparent; color:var(--muted); border:1px solid rgba(255,255,255,0.04); backdrop-filter: blur(6px);
  }

  /* hero visual right: planet + lens */
  .hero-right {
    position:relative; width:44%; min-height:120px; display:grid; place-items:center;
    pointer-events:none;
  }
  .planet {
    width:160px; height:160px; border-radius:50%; background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.06), rgba(5,10,22,1) 40%);
    box-shadow: inset -12px -8px 36px rgba(87,183,255,0.06), 0 30px 60px rgba(20,30,60,0.6);
    position:relative; transform: rotate(-8deg);
  }
  .planet::after {
    content:""; position:absolute; inset:0; border-radius:50%;
    background: conic-gradient(from 120deg, rgba(87,183,255,0.06), rgba(155,108,255,0.04), rgba(110,231,183,0.03));
    mix-blend-mode: screen; filter: blur(6px);
  }
  .planet-glow {
    position:absolute; inset:-22%; border-radius:50%; filter: blur(18px); opacity:0.9;
    background: radial-gradient(circle at 30% 30%, rgba(87,183,255,0.22), rgba(155,108,255,0.12), transparent 60%);
    transform: translateZ(0);
  }

  /* search area */
  .controls {
    display:flex; gap:16px; align-items:center; margin-top:8px;
  }
  .search {
    flex:1; display:flex; gap:10px; align-items:center;
    background: linear-gradient(180deg, rgba(255,255,255,0.018), rgba(255,255,255,0.01));
    padding:10px; border-radius:12px; border:1px solid rgba(255,255,255,0.03);
    box-shadow: inset 0 -1px 0 rgba(255,255,255,0.02);
  }
  .search input{
    flex:1; background:transparent; border:0; padding:8px 10px; color:inherit; outline:none; font-size:15px;
  }
  .search .icon { font-size:15px; color:var(--muted); padding:6px 8px; border-radius:8px; background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent); }

  .chips { margin-top:14px; display:flex; gap:10px; flex-wrap:wrap; }
  .chip { padding:8px 12px; border-radius:999px; font-weight:700; font-size:13px; color:var(--muted); border:1px solid rgba(255,255,255,0.03); background:transparent; cursor:pointer; }
  .chip.active { background: linear-gradient(90deg, rgba(87,183,255,0.12), rgba(155,108,255,0.10)); color:#041429; border:0; box-shadow: 0 8px 30px rgba(87,183,255,0.06); }

  /* results grid */
  .grid {
    display:grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap:14px; margin-top:18px;
  }
  .card {
    position:relative; overflow:hidden; border-radius:14px; padding:12px; display:flex; gap:12px; align-items:center; cursor:pointer;
    background: linear-gradient(180deg, rgba(255,255,255,0.015), transparent 60%);
    border:1px solid rgba(255,255,255,0.03); transition: transform .18s ease, box-shadow .18s ease;
    box-shadow: 0 8px 30px rgba(1,6,18,0.45);
  }
  .card:hover { transform: translateY(-8px) scale(1.01); box-shadow: 0 28px 100px rgba(20,30,80,0.6); }
  .thumb {
    width:72px; height:72px; min-width:72px; border-radius:10px; display:grid; place-items:center; font-weight:900;
    background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
    color:var(--muted);
  }
  .card .meta { display:flex; flex-direction:column; gap:6px; }
  .card .title { font-weight:800; font-size:15px; color:#e7f7ff; }
  .card .sub { font-size:12px; color:var(--muted); }

  .card .open {
    margin-left:auto; font-size:14px; color:var(--muted); padding:6px 8px; border-radius:8px; background:transparent;
  }

  /* right column: preview + contact */
  .right {
    align-self:start; display:flex; flex-direction:column; gap:14px; width:100%;
  }

  .preview {
    height:62vh; min-height:360px; border-radius:14px; overflow:hidden; position:relative;
    background: linear-gradient(180deg, rgba(2,6,12,0.8), rgba(3,7,16,0.6));
    border:1px solid rgba(255,255,255,0.03);
    box-shadow: 0 30px 80px rgba(1,6,18,0.6);
  }
  .preview header {
    display:flex; align-items:center; gap:12px; padding:12px 14px; border-bottom:1px solid rgba(255,255,255,0.02);
    background: linear-gradient(180deg, rgba(255,255,255,0.012), transparent);
  }
  .preview .title { font-weight:800; font-size:14px; color:#eaf6ff; }
  .preview iframe { width:100%; height: calc(100% - 56px); border:0; display:block; }

  .contact {
    padding:12px 14px; border-radius:12px; display:flex; justify-content:space-between; align-items:center;
    background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));
    border:1px solid rgba(255,255,255,0.02); color:var(--muted);
  }

  /* floating small controls */
  .mini {
    position:fixed; right:28px; bottom:20px; z-index:8; display:flex; gap:10px;
  }
  .mini button { padding:10px 12px; border-radius:12px; border:0; cursor:pointer; font-weight:700; background:linear-gradient(90deg,var(--accent2),var(--accent1)); color:#00122a; box-shadow:0 12px 40px rgba(92,122,255,0.12); }

  /* focus & accessibility */
  .chip:focus, .btn:focus, .card:focus, .mini button:focus { outline:2px solid rgba(110,231,183,0.12); outline-offset:4px; }

  /* responsive */
  @media (max-width:1100px){
    .shell { grid-template-columns: 1fr; padding:18px; }
    .right { order:2; }
    .preview { height:46vh; min-height:260px; }
  }

  @media (max-width:600px){
    .planet { width:110px; height:110px; }
    .hero { padding:18px; border-radius:12px; }
    .hub-title { font-size:20px; }
    .card { padding:10px; }
    .thumb { width:56px; height:56px; min-width:56px; }
  }

  /* little animated accent lines (for glam) */
  .glow-line {
    position:absolute; height:2px; left:-6%; right:-6%; top:12%; opacity:0.28;
    background: linear-gradient(90deg, rgba(87,183,255,0), rgba(87,183,255,0.45), rgba(155,108,255,0));
    filter: blur(6px); transform: rotate(-6deg);
  }
</style>
</head>
<body>

<!-- Visual layers -->
<div id="space" aria-hidden="true"></div>
<div class="nebula" aria-hidden="true"></div>
<div class="bloom" aria-hidden="true"></div>
<div class="grain" aria-hidden="true"></div>

<!-- shooting star canvas (on top of layers) -->
<canvas id="shoot" aria-hidden="true" style="position:fixed; inset:0; z-index:4; pointer-events:none;"></canvas>

<!-- Content shell -->
<div class="shell" role="main" aria-labelledby="hub-name">

  <!-- LEFT: hero, search, chips, grid -->
  <div class="left">
    <div class="hero" aria-hidden="false">
      <div class="hero-left">
        <h1 id="hub-name" class="hub-title">Bing's Hub</h1>
        <p class="hub-sub">A cinematic space library â€” glass panels, glowing nebula, and shooting stars. Press <kbd>/</kbd> to focus search.</p>

        <div class="hero-cta" style="margin-top:14px;">
          <button class="btn" id="shuffle">Surprise Me</button>
          <button class="btn ghost" id="clearBtn">Clear Search</button>
        </div>

        <div class="controls" style="margin-top:12px;">
          <div class="search" role="search" aria-label="Search items">
            <span class="icon">ðŸ”Ž</span>
            <input id="q" placeholder="Search movies, comics, shows..." aria-label="search input" autocomplete="off">
            <button id="qclear" title="clear" style="background:transparent;border:0;color:var(--muted);font-weight:700;cursor:pointer">âœ•</button>
          </div>
        </div>

        <div class="chips" id="genres"></div>

      </div>

      <div class="hero-right" aria-hidden="true">
        <div class="planet">
          <div class="planet-glow" style="transform: translateY(-6px) scale(1.08);"></div>
        </div>
        <div class="glow-line" aria-hidden="true"></div>
      </div>
    </div>

    <!-- results grid -->
    <div id="resultsGrid" class="grid" aria-live="polite" style="margin-top:18px;"></div>
  </div>

  <!-- RIGHT: preview + contact -->
  <aside class="right" aria-label="Preview and contact">
    <div class="preview" id="previewPanel" aria-hidden="false">
      <header>
        <div class="title" id="previewTitle">Click an item to preview â€” or open in a new tab</div>
        <div style="margin-left:auto;display:flex;gap:8px;">
          <button id="openNew" title="Open in new tab" class="btn ghost" style="font-weight:700;">â†— Open</button>
          <button id="closePreview" title="Close preview" class="btn ghost">âœ•</button>
        </div>
      </header>
      <iframe id="previewFrame" srcdoc="<div style='display:grid;place-items:center;height:100%;color:#a8cbe8;background:linear-gradient(180deg,#061026,#081426);font-family:Inter,sans-serif'><div style='text-align:center;padding:24px'><h2 style='margin:0 0 8px'>No preview</h2><div style='opacity:0.8'>Select an item from the left to preview it here.</div></div></div>" title="Preview"></iframe>
    </div>

    <div class="contact">
      <div>contact</div>
      <div style="font-weight:700"><a href="mailto:30barmarsh@gmail.com" style="color:inherit;text-decoration:underline">30barmarsh@gmail.com</a></div>
    </div>
  </aside>

</div>

<!-- small floating utilities -->
<div class="mini" aria-hidden="true">
  <button id="toggleStars">Stars âœ¦</button>
  <button id="themeSwap">Swap Glow</button>
</div>

<script>
/* ============================
   Data (copied from your original items)
   ============================ */
const items = [
  {title: "The CupHead Show", url: "https://drive.google.com/drive/folders/1j_K1YV4w_sHAzwEAaUMl-qSk4qjrYSJ_", genre: "Cartoons"},
  {title: "Five Nights at Freddy's full movie", url: "https://drive.google.com/file/d/1OyO1OdhtfwR883Uvi0QPP5iooGcxTVSY/view", genre: "Horror"},
  {title: "Kirby: Right Back At Ya!", url: "https://drive.google.com/drive/folders/1LawIFQ48UCdP3-VUan7iWTm4l5EonWYw", genre: "Cartoons"},
  {title: "Avengers Endgame (2019)", url: "https://drive.google.com/file/d/1UsxNtlBxGFp955GwEB-s8wYJCA6bXt7e/view", genre: "Movies"},
  {title: "Ant-Man And The Wasp", url: "https://drive.google.com/file/d/1AstKQ5KLX94k7RFIlsu2St9um8sS_w_M/view", genre: "Movies"},
  {title: "Black Panther (2018)", url: "https://drive.google.com/file/d/1GdMksUpH7ghCBF1j4sEmJU9hmZ3pPpkn/view", genre: "Movies"},
  {title: "Zootopia (2016)", url: "https://drive.google.com/file/d/1HYeIrbf8A-vfvJsvYP59AQzG9l8nt03h/view", genre: "Movies"},
  {title: "Garfield & Friends", url: "https://drive.google.com/drive/folders/1u9Pr61UADQ2cTYvkIkqpEjCzJf9bM9Ic", genre: "Shows"},
  {title: "Gravity Falls", url: "https://drive.google.com/drive/folders/1Q6s6AB7BAOndbFy4xcnuX4FjO8uHnqaZ", genre: "Shows"},
  {title: "Smiling Friends", url: "https://drive.google.com/drive/folders/1px8IK0jaSlqj3fK-yawRwD0aQD4pXGld", genre: "Shows"},
  {title: "SpongeBob Seasons 1-15", url: "https://drive.google.com/drive/folders/1cOFMumtLFERJqS6Y5oTyBb6ZRXNHCgZF", genre: "Shows"},
  {title: "Sonic the Hedgehog Comics", url: "https://drive.google.com/drive/folders/1Rl63s8mf0P41xy-bVNamLoEz7xAkf-nL", genre: "Comics"},
  {title: "Invincible (1-144)", url: "https://drive.google.com/drive/folders/1s21qKWyfqZeqr5ptjJDCFIrUSCPrVMhb", genre: "Comics"},
  {title: "Jujutsu Kaisen S1", url: "https://drive.google.com/drive/folders/1pQ5CC4NeCB9bj-IrIHeu2x3nskc4gPeS", genre: "Anime"},
  {title: "One Punch Man", url: "https://drive.google.com/drive/folders/1yGjMeMX0_1vUHa6XbpszYGe5yLqYLKRc", genre: "Anime"},
  {title: "Adventure Time", url: "https://drive.google.com/drive/folders/1OwoKydzUQUUp6n-Nh7CCAQXGLfchU8Ta", genre: "Cartoons"},
];

/* ============================
   UI wiring: genres, search, grid, preview
   ============================ */

const fixedGenres = ["All","Movies","Comics","Shows","Horror","Cartoons","Comedy","Anime"];
const genresEl = document.getElementById('genres');
genresEl.innerHTML = fixedGenres.map((g,i)=>`<button class="chip ${i===0?'active':''}" data-genre="${g}" tabindex="0">${g}</button>`).join('');
genresEl.addEventListener('click', e=>{
  const btn = e.target.closest('.chip'); if(!btn) return;
  document.querySelectorAll('.chip').forEach(c=>c.classList.remove('active')); btn.classList.add('active'); renderGrid();
});
genresEl.addEventListener('keydown', e=> {
  if(e.key === 'Enter') e.target.click();
});

const q = document.getElementById('q');
document.getElementById('qclear').addEventListener('click', ()=>{ q.value=''; renderGrid(); });
document.getElementById('clearBtn').addEventListener('click', ()=>{ q.value=''; renderGrid(); });
document.getElementById('shuffle').addEventListener('click', ()=>{ const r = items[Math.floor(Math.random()*items.length)]; openItemByRef(r); });

q.addEventListener('input', renderGrid);

/* escape html for titles */
function escapeHtml(s){ return String(s).replace(/[&<>"]/g, c=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;' }[c])); }

const grid = document.getElementById('resultsGrid');
function renderGrid(){
  const query = q.value.trim().toLowerCase();
  const active = document.querySelector('.chip.active')?.dataset.genre || 'All';
  const filtered = items.filter(i=>{
    if(active !== 'All' && i.genre.toLowerCase() !== active.toLowerCase()) return false;
    if(!query) return true;
    return (i.title + ' ' + i.genre).toLowerCase().includes(query);
  });

  if(filtered.length === 0){
    grid.innerHTML = `<div style="color:var(--muted);padding:18px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent);border:1px solid rgba(255,255,255,0.02)">Nothing found</div>`;
    return;
  }

  grid.innerHTML = filtered.map((it, idx) => {
    const initials = it.title.split(' ').slice(0,2).map(s => (s[0]||'')).join('').toUpperCase();
    // use data-index attribute to map back to original items array; we will use indexOf
    return `<div class="card" role="button" tabindex="0" data-url="${escapeHtml(it.url)}" data-title="${escapeHtml(it.title)}" data-genre="${escapeHtml(it.genre)}">
      <div class="thumb">${escapeHtml(initials)}</div>
      <div class="meta">
        <div class="title">${escapeHtml(it.title)}</div>
        <div class="sub">${escapeHtml(it.genre)}</div>
      </div>
      <div class="open" aria-hidden="true">â†—</div>
    </div>`;
  }).join('');
  // attach listeners
  document.querySelectorAll('.card').forEach(c=>{
    c.addEventListener('click', ()=> openItemByEl(c));
    c.addEventListener('keydown', e=>{ if(e.key === 'Enter') openItemByEl(c); });
  });
}
renderGrid();

/* ============================
   Preview iframe handling
   ============================ */
const previewFrame = document.getElementById('previewFrame');
const previewTitle = document.getElementById('previewTitle');
const openNew = document.getElementById('openNew');
const closePreview = document.getElementById('closePreview');

let currentUrl = null;

function openItemByEl(el){
  const url = el.dataset.url;
  const title = el.dataset.title;
  openPreview(url, title);
}
function openItemByRef(ref){
  openPreview(ref.url, ref.title);
}

function openPreview(url, title){
  currentUrl = url;
  previewTitle.textContent = title;
  // For many share links (google drive) embedding won't allow iframe display due to X-Frame-Options.
  // We'll try to load the URL directly, but if cross-frame is blocked, user can open in a new tab with the button.
  // To give a nicer preview for unsupported frames we use srcdoc fallback message.
  previewFrame.src = url;
  // small visual pulse
  document.getElementById('previewPanel').animate([{boxShadow:'0 30px 80px rgba(1,6,18,0.6)'},{boxShadow:'0 44px 130px rgba(87,183,255,0.08)'}],{duration:400,fill:'forwards'});
  openNew.disabled = false;
}

openNew.addEventListener('click', ()=>{
  if(!currentUrl) return;
  window.open(currentUrl, '_blank');
});

closePreview.addEventListener('click', ()=> {
  currentUrl = null;
  previewTitle.textContent = 'Click an item to preview â€” or open in a new tab';
  previewFrame.srcdoc = "<div style='display:grid;place-items:center;height:100%;color:#a8cbe8;background:linear-gradient(180deg,#061026,#081426);font-family:Inter,sans-serif'><div style='text-align:center;padding:24px'><h2 style='margin:0 0 8px'>No preview</h2><div style='opacity:0.8'>Select an item from the left to preview it here.</div></div></div>";
});

/* ============================
   Keyboard shortcut focus
   ============================ */
window.addEventListener('keydown', (e)=>{
  if(e.key === '/') { e.preventDefault(); q.focus(); }
});

/* ============================
   Shooting stars canvas
   ============================ */
const canvas = document.getElementById('shoot');
const ctx = canvas.getContext('2d', { alpha: true });
let DPR = Math.max(1, window.devicePixelRatio || 1);
function resizeCanvas(){
  DPR = Math.max(1, window.devicePixelRatio || 1);
  canvas.width = Math.floor(window.innerWidth * DPR);
  canvas.height = Math.floor(window.innerHeight * DPR);
  canvas.style.width = window.innerWidth + 'px';
  canvas.style.height = window.innerHeight + 'px';
  ctx.setTransform(DPR,0,0,DPR,0,0);
}
resizeCanvas();
window.addEventListener('resize', resizeCanvas);

const stars = [];
const STAR_COUNT = Math.round((window.innerWidth * window.innerHeight) / 14000);
for(let i=0;i<STAR_COUNT;i++){
  stars.push({
    x: Math.random() * window.innerWidth,
    y: Math.random() * window.innerHeight,
    r: Math.random()*1.6 + 0.2,
    alpha: Math.random()*0.9 + 0.1,
    twinkleSpeed: Math.random()*0.02 + 0.002,
    phase: Math.random()*Math.PI*2
  });
}

const shooting = [];
function spawn(){
  const fromLeft = Math.random() < 0.55;
  const startX = fromLeft ? -50 : window.innerWidth + 50;
  const startY = Math.random() * window.innerHeight * 0.45;
  const angle = (Math.random()*18 + 8) * Math.PI/180;
  const speed = Math.random()*850 + 450;
  const dir = fromLeft ? 1 : -1;
  shooting.push({
    x: startX, y: startY, vx: Math.cos(angle)*speed*dir, vy: Math.sin(angle)*speed, life:0, ttl: Math.random()*800 + 500, len: Math.random()*220 + 120
  });
  setTimeout(spawn, Math.random()*3000 + 900);
}
setTimeout(spawn, 600);

let last = performance.now();
function frame(now){
  const dt = Math.min(40, now - last);
  last = now;
  // clear
  ctx.clearRect(0,0,canvas.width/DPR,canvas.height/DPR);

  // draw faint stars
  for(let s of stars){
    s.phase += s.twinkleSpeed * (dt/16);
    const a = s.alpha * (0.55 + Math.sin(s.phase)*0.45);
    ctx.beginPath();
    ctx.fillStyle = `rgba(255,255,255,${a})`;
    ctx.arc(s.x, s.y, s.r, 0, Math.PI*2);
    ctx.fill();
  }

  // shooting stars
  for(let i = shooting.length-1; i>=0; i--){
    const st = shooting[i];
    st.x += st.vx * (dt/1000);
    st.y += st.vy * (dt/1000);
    st.life += dt;
    const t = st.life / st.ttl;

    // trail (soft)
    ctx.save();
    const tx = st.x - st.vx/40;
    const ty = st.y - st.vy/40;
    const grad = ctx.createLinearGradient(st.x, st.y, tx, ty);
    grad.addColorStop(0, 'rgba(255,255,255,0.95)');
    grad.addColorStop(1, 'rgba(255,255,255,0)');
    ctx.strokeStyle = grad;
    ctx.lineWidth = 2.6;
    ctx.beginPath();
    ctx.moveTo(st.x, st.y);
    ctx.lineTo(st.x - st.vx/50, st.y - st.vy/50);
    ctx.stroke();

    // head
    ctx.beginPath();
    ctx.fillStyle = `rgba(255,255,255,${1 - t})`;
    ctx.arc(st.x, st.y, 2.6 + (1-t)*2, 0, Math.PI*2);
    ctx.fill();
    ctx.restore();

    if(st.life > st.ttl || st.x < -200 || st.x > window.innerWidth + 200 || st.y > window.innerHeight + 300){
      shooting.splice(i,1);
    }
  }

  requestAnimationFrame(frame);
}
requestAnimationFrame(frame);

/* ============================
   Small toggles
   ============================ */
let starsOn = true;
document.getElementById('toggleStars').addEventListener('click', ()=>{
  starsOn = !starsOn;
  document.querySelector('.grain').style.opacity = starsOn ? 0.02 : 0;
  document.querySelector('.nebula').style.opacity = starsOn ? 1 : 0.35;
});

document.getElementById('themeSwap').addEventListener('click', ()=>{
  // swap accent hues for a quick glow change
  const root = document.documentElement;
  const tmp1 = getComputedStyle(root).getPropertyValue('--accent1');
  root.style.setProperty('--accent1', getComputedStyle(root).getPropertyValue('--accent2'));
  root.style.setProperty('--accent2', tmp1);
});

/* ============================
   Small UX improvements
   ============================ */
document.body.addEventListener('click', (e) => {
  // if user clicks outside search and presses clear, remove focus
  if(!e.target.closest('.search')) { /* nothing for now */ }
});

// try to focus search on load
setTimeout(()=>{ q.focus(); }, 450);

/* ============================
   Notes:
   - Some external links (Google Drive) block being loaded in iframes due to security headers.
   - If preview frame doesn't show a site, use "Open" to open in a new tab.
   ============================ */
</script>

</body>
</html>
